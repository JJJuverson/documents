(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{428:function(s,a,n){"use strict";n.r(a);var e=n(3),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"什么是promise"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#什么是promise"}},[s._v("#")]),s._v(" "),n("a",{attrs:{href:"https://www.jianshu.com/p/1b63a13c2701",target:"_blank",rel:"noopener noreferrer"}},[s._v("什么是promise"),n("OutboundLink")],1)]),s._v(" "),n("ul",[n("li",[s._v("1、主要用于异步计算")]),s._v(" "),n("li",[s._v("2、可以将异步操作队列化，按照期望的顺序执行，返回符合预期的结果")]),s._v(" "),n("li",[s._v("3、可以在对象之间传递和操作promise，帮助我们处理队列")])]),s._v(" "),n("h2",{attrs:{id:"为什么用promise"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#为什么用promise"}},[s._v("#")]),s._v(" 为什么用promise")]),s._v(" "),n("ul",[n("li",[s._v("异步回调的问题：")]),s._v(" "),n("li",[s._v("之前处理异步是通过纯粹的回调函数的形式进行处理很容易进入到回调地狱中，剥夺了函数return的能力\n问题可以解决，但是难以读懂，维护困难稍有不慎就会踏入回调地狱 - 嵌套层次深，不好维护")]),s._v(" "),n("li",[s._v("一般情况我们一次性调用API就可以完成请求。有些情况需要多次调用服务器API，就会形成一个链式调用。\n比如为了完成一个功能，我们需要调用API1、API2、API3，依次按照顺序进行调用，这个时候就会出现回调地狱的问题")]),s._v(" "),n("li",[s._v("promise是一个对象，对象和函数的区别就是对象可以保存状态，函数不可以（闭包除外）")]),s._v(" "),n("li",[s._v("并未剥夺函数return的能力，因此无需层层传递callback，进行回调获取数据")]),s._v(" "),n("li",[s._v("代码风格，容易理解，便于维护")]),s._v(" "),n("li",[s._v("多个异步等待合并便于解决")])]),s._v(" "),n("h2",{attrs:{id:"promise详解"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#promise详解"}},[s._v("#")]),s._v(" promise详解")]),s._v(" "),n("ul",[n("li",[s._v("promise有三个状态：")]),s._v(" "),n("li",[s._v("1、pending[待定]初始状态")]),s._v(" "),n("li",[s._v("2、resolved[实现]操作成功,在异步操作成功时调用，并将异步操作的结果，作为参数传递出去；")]),s._v(" "),n("li",[s._v("3、rejected[被否决]操作失败,将Promise对象的状态从“未完成”变为“失败”（即从 pending 变为 rejected），在异步操作失败时调用，并将异步操作报出的错误，作为参数传递出去。")]),s._v(" "),n("li",[s._v("当promise状态发生改变，就会触发then()里的响应函数处理后续步骤；promise状态一经改变，不会再变。")]),s._v(" "),n("li",[s._v("注：Promise对象的状态改变，只有两种可能：从pending变为resolved，从pending变为rejected。\n这两种情况只要发生，状态就凝固了，不会再变了")])]),s._v(" "),n("h2",{attrs:{id:"什么是axios"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#什么是axios"}},[s._v("#")]),s._v(" "),n("a",{attrs:{href:"http://www.axios-js.com/zh-cn/docs/",target:"_blank",rel:"noopener noreferrer"}},[s._v("什么是axios"),n("OutboundLink")],1)]),s._v(" "),n("ul",[n("li",[s._v("Axios 是一个基于 promise 的 HTTP 库，可以用在浏览器和 node.js 中。")])]),s._v(" "),n("h2",{attrs:{id:"安装使用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装使用"}},[s._v("#")]),s._v(" 安装使用")]),s._v(" "),n("blockquote",[n("p",[s._v("yarn add axios --save")])]),s._v(" "),n("h2",{attrs:{id:"在vue中封装axios"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#在vue中封装axios"}},[s._v("#")]),s._v(" 在vue中封装axios")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("import axios from 'axios'\n\n/**\n * 调用get和post请求(基于promise, 基于axios)\n * @param url\n * @param params\n * @param type\n * @returns {Promise<any>}\n * api.itlike.com/api/gethome?id=001&name=zhangsan&\n *\n */\nexport default function ajax(url = '', params = {}, type = 'GET') {\n     // 1. 定义promise对象\n     let promise;\n     return new Promise((resolve, reject)=>{\n        // 2. 判断请求的方式\n        if('GET' === type){\n              // 2.1 拼接请求字符串\n              let paramsStr = '';\n              Object.keys(params).forEach(key =>{\n                 paramsStr += key + '=' + params[key] + '&'\n              });\n              // 2.2 过滤最后的&\n              if(paramsStr !== ''){\n                 paramsStr = paramsStr.substr(0, paramsStr.lastIndexOf('&'))\n              }\n              // 2.3 完整路径\n              url += '?' + paramsStr;\n              // 2.4 发送get请求\n              promise = axios.get(url)\n        }else if('POST' === type){\n              promise = axios.post(url, params)\n        }\n        // 3. 返回请求的结果\n        promise.then((response)=>{\n            resolve(response.data)\n        }).catch(error => {\n           reject(error)\n        })\n     })\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br")])]),n("h2",{attrs:{id:"调用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#调用"}},[s._v("#")]),s._v(" 调用")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("import ajax from './ajax'\n\n// 1. 基础路径\nconst BASE_URL = 'http://127.0.0.1:3000';\n\n// 2. 请求方法\n\n// 2.1 请求首页的轮播图\nexport const getHomeCasual = ()=>ajax(BASE_URL + '/api/homecasual');\n\n// 2.2 请求首页的导航\nexport const getHomeNav = ()=>ajax(BASE_URL + '/api/homenav');\n\n// 2.3 请求首页的商品数据\nexport const getHomeShopList = ()=>ajax(BASE_URL + '/api/homeshoplist');\n\n// 2.4 请求推荐的商品数据\nexport const getRecommendShopList = ()=>ajax(BASE_URL + '/api/recommendshoplist');\n\n// 2.5 请求搜索的列表数据\nexport const getSearchGoods = ()=>ajax(BASE_URL + '/api/searchgoods');\n\n\n\n\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br")])])])}),[],!1,null,null,null);a.default=r.exports}}]);